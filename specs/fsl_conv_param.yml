BET:
  name: BET
  filename: bet
  cmd: bet
  output_files:
    out_file: [in_file]
    mask_file:
      - [mask: True]
      - [reduce_bias: True]
    outline_file: [outline: True]
    meshfile:
      - [mesh: True]
      - [surfaces: True]
    inskull_mask_file: [surfaces: True]
    inskull_mesh_file: [surfaces: True]
    outskull_mask_file: [surfaces: True]
    outskull_mesh_file: [surfaces: True]
    outskin_mask_file: [surfaces: True]
    outskin_mesh_file: [surfaces: True]
    skull_mask_file: [surfaces: True]
    skull_file: [skull: True]

  output_templates:
    out_file: "{in_file}_brain"
    mask_file: "{out_file}_mask"
    outline_file: "{out_file}_overlay"
    meshfile: "{out_file}_mesh.vtk"
    inskull_mask_file: "{out_file}_inskull_mask"
    inskull_mesh_file: "{out_file}_inskull_mesh"
    outskull_mask_file: "{out_file}_outskull_mask"
    outskull_mesh_file: "{out_file}_outskull_mesh"
    outskin_mask_file: "{out_file}_outskin_mask"
    outskin_mesh_file: "{out_file}_outskin_mesh"
    skull_mask_file: "{out_file}_skull_mask"
    skull_file: "{out_file}_skull"

  tests_inputs:
    -
    - mask: True
    - surfaces: True

  tests_outputs:
    - out_file
    - [out_file, mask_file]
    - [out_file, meshfile, inskull_mask_file, inskull_mesh_file, outskull_mask_file,
       outskull_mesh_file, outskin_mask_file, outskin_mesh_file, skull_mask_file]


FAST:
  name: FAST
  filename: fast
  cmd: fast

  inputs_metadata:
    number_classes:
      default: 3

  output_files:
    tissue_class_files: [segments: True]
    partial_volume_map: [no_pve: False] # possibly [False, None, attr.NOTHING]
    partial_volume_files: [no_pve: False] # possibly [False, None, attr.NOTHING]
    bias_field: [output_biasfield: True]
    probability_maps: [probability_maps: True]

  outputs_callables:
    tissue_class_map: FAST_output
    tissue_class_files: FAST_output_nclass
    restored_image: FAST_output_infile
    mixeltype: FAST_output
    partial_volume_map: FAST_output
    partial_volume_files: FAST_output_nclass
    bias_field: FAST_output_infile
    probability_maps: FAST_output_nclass


  tests_inputs:
    -

  tests_outputs:
    - AttributeError


MCFLIRT:
  name: MCFLIRT
  filename: mcflirt
  cmd: mcflirt
  output_files:
    out_file: [in_file]
    variance_img: [in_file, stats_imgs: True]
    std_img: [in_file, stats_imgs: True]
    mean_img: [in_file, mean_vol: True]
    par_file: [save_plots]
#    mat_file:
#    rms_files: [save_rms]


  output_templates:
    out_file: "{in_file}_mcf"
    variance_img: "{out_file}_variance.ext"
    std_img: "{out_file}_sigma.ext"
    mean_img: "{out_file}_mean_reg.ext"
    par_file: "{out_file}.par"
#    mat_file:
#    rms_files:

  tests_inputs:
    -

  tests_outputs:
    - out_file


FLIRT:
  name: FLIRT
  filename: flirt
  cmd: flirt
  output_files:

  output_templates:


  tests_inputs:
    -

  tests_outputs:
    - AttributeError


FNIRT:
  name: FNIRT
  filename: fnirt
  cmd: fnirt

  output_files:
    warped_file: [in_file]
    field_file: [in_file]
    jacobian_file: [in_file]
    modulatedref_file: [in_file]
    #out_intensitymap_file: [in_file]
    log_file: [in_file]
    fieldcoeff_file: [in_file]


  output_templates:
    warped_file: "{in_file}_warped"
    field_file: "{in_file}_field"
    jacobian_file: "{in_file}_field_jacobian"
    modulatedref_file: "{in_file}_modulated"
    #out_intensitymap_file: "{in_file}_intmap"
    log_file: "{in_file}_log.txt"
    fieldcoeff_file: "{in_file}_fieldwarp"

  tests_inputs:
    -
    - ref_file: f"{in_file}"

  tests_outputs:
    - AttributeError
    - [warped_file, field_file, jacobian_file, modulatedref_file, log_file, fieldcoeff_file]


ApplyWarp:
  name: ApplyWarp
  filename: applywarp
  cmd: applywarp

  output_templates:
    out_file: "{in_file}_warp"

  tests_inputs:
    - ref_file: f"{in_file}"

  tests_outputs:
    - out_file


SliceTimer:
  name: SliceTimer
  filename: slicetime
  cmd: slicetimer

  output_files:
    slice_time_corrected_file: [out_file]

  output_templates:
    out_file: "{in_file}_st"
    slice_time_corrected_file: "{out_file}"

  tests_inputs:
    - ref_file: f"{in_file}"

  tests_outputs:
    - [out_file, slice_time_corrected_file]


SUSAN:
  name: SUSAN
  filename: susan
  cmd: susan

  output_files:
    smoothed_file: [out_file]

  output_templates:
    out_file: "{in_file}_smooth"
    smoothed_file: "{out_file}"

  tests_inputs:
    -
    -
      brightness_threshold: 0.01
      fwhm: 2

  tests_outputs:
    - AttributeError
    - [out_file, smoothed_file]


PRELUDE:
  name: PRELUDE
  filename: prelude
  cmd: prelude

  output_files:
    unwrapped_phase_file: [phase_file]

  output_templates:
    unwrapped_phase_file: "{phase_file}_unwrapped"

  tests_inputs:
    -

  tests_outputs:
    - AttributeError


FIRST:
  name: FIRST
  filename: first
  cmd: run_first_all

  output_files:
    original_segmentations: [in_file]
    segmentation_file: [in_file]
    vtk_surfaces: [in_file]
    bvars: [in_file]

  output_templates:
    original_segmentations: "{in_file}_original_segmentations"
    segmentation_file: "{in_file}_segmentation_file"
    vtk_surfaces: "{in_file}_vtk_surfaces"
    bvars: "{in_file}_bvars"

  tests_inputs:
    -

  tests_outputs:
    - AttributeError
